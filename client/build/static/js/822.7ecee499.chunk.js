"use strict";(self.webpackChunkvolunteer_management_client=self.webpackChunkvolunteer_management_client||[]).push([[822],{3822:(e,s,a)=>{a.r(s),a.d(s,{default:()=>l});var r=a(5043),t=a(5016),o=a(8254),n=a(579);const l=()=>{const{user:e}=(0,t.A)(),[s,a]=(0,r.useState)(1),[l,i]=(0,r.useState)({beggar_name:"",beggar_age:"",beggar_gender:"",beggar_photo:null,location_coordinates:null,location_address:"",survey_notes:""}),[d,c]=(0,r.useState)(!1),[g,m]=(0,r.useState)(null),x=[{id:1,title:"Beggar Details",icon:o.JXP},{id:2,title:"Location",icon:o.HzC},{id:3,title:"Photo & Notes",icon:o.PoE},{id:4,title:"Review & Submit",icon:o.A3x}],u=(e,s)=>{i(a=>({...a,[e]:s}))},h=()=>{s<x.length&&a(s+1)},b=()=>{s>1&&a(s-1)},p=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{const{latitude:s,longitude:a}=e.coords;u("location_coordinates",[s,a])},e=>{console.error("Error getting location:",e),alert("Unable to get your location. Please enter coordinates manually.")}):alert("Geolocation is not supported by this browser.")},y=e=>{const s=e.target.files[0];if(s){const e=new FileReader;e.onload=e=>{u("beggar_photo",e.target.result)},e.readAsDataURL(s)}},v=async()=>{try{c(!0),m(null);const e={beggar_name:l.beggar_name||void 0,beggar_age:l.beggar_age?parseInt(l.beggar_age):void 0,beggar_gender:l.beggar_gender||void 0,beggar_photo_url:l.beggar_photo||void 0,location_coordinates:l.location_coordinates,location_address:l.location_address||void 0,survey_notes:l.survey_notes||void 0},s=localStorage.getItem("token");console.log("\ud83d\udd0d Debug: Token exists:",!!s),console.log("\ud83d\udd0d Debug: Survey data:",e);const a=await fetch("/api/volunteer/surveys",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(e)});if(console.log("\ud83d\udd0d Debug: Response status:",a.status),console.log("\ud83d\udd0d Debug: Response ok:",a.ok),!a.ok){const e=await a.json();throw console.log("\ud83d\udd0d Debug: Error data:",e),new Error(e.error||"Failed to create survey")}const r=await a.json();console.log("\ud83d\udd0d Debug: Success result:",r),alert("Survey created successfully!"),window.location.href="/volunteer/surveys"}catch(g){console.error("Error creating survey:",g),m(g.message)}finally{c(!1)}};return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,n.jsx)("div",{className:"flex justify-between items-center py-4",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("button",{onClick:()=>window.location.href="/volunteer/surveys",className:"mr-4 text-gray-600 hover:text-gray-900",children:(0,n.jsx)(o.kRp,{className:"w-5 h-5"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"New Survey"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Create a new survey for a beggar"})]})]})})})}),(0,n.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,n.jsx)("div",{className:"mb-8",children:(0,n.jsx)("div",{className:"flex items-center justify-between",children:x.map((e,a)=>{const r=e.icon,t=s===e.id,l=s>e.id;return(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full border-2 "+(t?"border-primary-600 bg-primary-600 text-white":l?"border-green-600 bg-green-600 text-white":"border-gray-300 bg-white text-gray-400"),children:l?(0,n.jsx)(o.A3x,{className:"w-5 h-5"}):(0,n.jsx)(r,{className:"w-5 h-5"})}),(0,n.jsx)("div",{className:"ml-3",children:(0,n.jsx)("p",{className:"text-sm font-medium "+(t?"text-primary-600":l?"text-green-600":"text-gray-500"),children:e.title})}),a<x.length-1&&(0,n.jsx)("div",{className:"flex-1 h-0.5 mx-4 "+(l?"bg-green-600":"bg-gray-300")})]},e.id)})})}),(0,n.jsx)("div",{className:"card",children:(()=>{switch(s){case 1:return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Beggar Information"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name (if known)"}),(0,n.jsx)("input",{type:"text",value:l.beggar_name,onChange:e=>u("beggar_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Enter name if known"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Age (if known)"}),(0,n.jsx)("input",{type:"number",value:l.beggar_age,onChange:e=>u("beggar_age",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Enter age",min:"0",max:"120"})]})]}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender"}),(0,n.jsxs)("select",{value:l.beggar_gender,onChange:e=>u("beggar_gender",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,n.jsx)("option",{value:"",children:"Select gender"}),(0,n.jsx)("option",{value:"male",children:"Male"}),(0,n.jsx)("option",{value:"female",children:"Female"}),(0,n.jsx)("option",{value:"other",children:"Other"}),(0,n.jsx)("option",{value:"unknown",children:"Unknown"})]})]})]}),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)("button",{onClick:h,className:"bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700",children:"Next"})})]});case 2:return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Location Information"}),(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsx)("button",{type:"button",onClick:p,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 mb-4",children:"Get Current Location"})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Latitude"}),(0,n.jsx)("input",{type:"number",step:"any",value:l.location_coordinates?l.location_coordinates[0]:"",onChange:e=>{const s=parseFloat(e.target.value),a=l.location_coordinates?l.location_coordinates[1]:null;u("location_coordinates",null!==a?[s,a]:null)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Enter latitude"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longitude"}),(0,n.jsx)("input",{type:"number",step:"any",value:l.location_coordinates?l.location_coordinates[1]:"",onChange:e=>{const s=parseFloat(e.target.value),a=l.location_coordinates?l.location_coordinates[0]:null;u("location_coordinates",null!==a?[a,s]:null)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Enter longitude"})]})]}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address (optional)"}),(0,n.jsx)("textarea",{value:l.location_address,onChange:e=>u("location_address",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:"3",placeholder:"Enter address or landmark"})]})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("button",{onClick:b,className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-md hover:bg-gray-400",children:"Previous"}),(0,n.jsx)("button",{onClick:h,disabled:!l.location_coordinates,className:"bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]});case 3:return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Photo & Additional Notes"}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Photo (optional)"}),(0,n.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:y,className:"hidden",id:"photo-upload"}),(0,n.jsx)("label",{htmlFor:"photo-upload",className:"cursor-pointer",children:l.beggar_photo?(0,n.jsxs)("div",{children:[(0,n.jsx)("img",{src:l.beggar_photo,alt:"Uploaded photo",className:"w-32 h-32 object-cover rounded-lg mx-auto mb-2"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Click to change photo"})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)(o.PoE,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Click to upload photo"})]})})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes (optional)"}),(0,n.jsx)("textarea",{value:l.survey_notes,onChange:e=>u("survey_notes",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",rows:"4",placeholder:"Enter any additional observations or notes..."})]})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("button",{onClick:b,className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-md hover:bg-gray-400",children:"Previous"}),(0,n.jsx)("button",{onClick:h,className:"bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700",children:"Next"})]})]});case 4:return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Review & Submit"}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-gray-900",children:"Beggar Information"}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:["Name: ",l.beggar_name||"Not provided",(0,n.jsx)("br",{}),"Age: ",l.beggar_age||"Not provided",(0,n.jsx)("br",{}),"Gender: ",l.beggar_gender||"Not provided"]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-gray-900",children:"Location"}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:["Coordinates: ",l.location_coordinates?`${l.location_coordinates[0].toFixed(6)}, ${l.location_coordinates[1].toFixed(6)}`:"Not provided",(0,n.jsx)("br",{}),"Address: ",l.location_address||"Not provided"]})]}),l.beggar_photo&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-gray-900",children:"Photo"}),(0,n.jsx)("img",{src:l.beggar_photo,alt:"Beggar photo",className:"w-32 h-32 object-cover rounded-lg"})]}),l.survey_notes&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-gray-900",children:"Notes"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:l.survey_notes})]})]})]}),g&&(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,n.jsx)("p",{className:"text-red-800",children:g})}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("button",{onClick:b,className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-md hover:bg-gray-400",children:"Previous"}),(0,n.jsx)("button",{onClick:v,disabled:d||!l.location_coordinates,className:"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Submitting...":"Submit Survey"})]})]});default:return null}})()})]})]})}}}]);
//# sourceMappingURL=822.7ecee499.chunk.js.map